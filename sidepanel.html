<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Downloader - Download Manager</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="side-panel">
    <!-- Header Section -->
    <div class="header">
      <h1>
        <span>üìä</span>
        <span>Download Manager</span>
      </h1>
      <div class="status-info">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Ready</span>
      </div>
    </div>

    <!-- Controls Section -->
    <div class="controls flex gap-2">
      <button id="scanBtn" class="btn">
        <span>üîç</span>
        <span>Scan Page</span>
      </button>
      <button id="clearBtn" class="btn btn-secondary">
        <span>üóëÔ∏è</span>
        <span>Clear All</span>
      </button>
    </div>

    <!-- Statistics Section -->
    <div class="section">
      <div class="section-title">Statistics</div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value" id="totalVideos">0</div>
          <div class="stat-label">Videos Found</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="activeDownloads">0</div>
          <div class="stat-label">Downloading</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="completedDownloads">0</div>
          <div class="stat-label">Completed</div>
        </div>
      </div>
    </div>

    <!-- Active Downloads Section -->
    <div class="section">
      <div class="section-title">Active Downloads</div>
      <div id="activeDownloadsList" class="downloads-list">
        <div class="no-videos">No active downloads</div>
      </div>
    </div>

    <!-- Available Videos Section -->
    <div class="section">
      <div class="section-title">Available Videos</div>
      <div id="videosList" class="video-list">
        <div class="no-videos">Click "Scan Page" to find downloadable videos</div>
      </div>
    </div>

    <!-- Download History Section -->
    <div class="section">
      <div class="section-title">Recent Downloads</div>
      <div id="downloadHistory" class="downloads-list">
        <div class="no-videos">No recent downloads</div>
      </div>
    </div>

    <script src="sidepanel.js"></script>
  </body>
</html>
        color: var(--label-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        letter-spacing: -0.4px;
      }

      .status-info {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: var(--text-caption1);
        color: var(--label-secondary);
        font-weight: 500;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: var(--system-green);
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      .status-dot.scanning {
        background-color: var(--system-orange);
      }

      .status-dot.error {
        background-color: var(--system-red);
        animation: none;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }

      .controls {
        display: flex;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
      }

      .btn {
        padding: var(--spacing-sm) var(--spacing-md);
        border: none;
        border-radius: var(--radius-sm);
        background: var(--system-blue);
        color: white;
        cursor: pointer;
        font-size: var(--text-subhead);
        font-weight: 600;
        font-family: inherit;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        min-height: 44px; /* Apple's minimum touch target */
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .btn:hover {
        background: var(--system-blue-hover);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
      }

      .btn:active {
        transform: translateY(0);
        box-shadow: var(--shadow-sm);
      }

      .btn:disabled {
        background: var(--system-gray3);
        color: var(--label-quaternary);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn.secondary {
        background: var(--fill-tertiary);
        color: var(--system-blue);
        border: 0.5px solid var(--separator);
      }

      .btn.secondary:hover {
        background: var(--fill-secondary);
        color: var(--system-blue-hover);
      }

      .status {
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        margin-bottom: var(--spacing-md);
        font-size: var(--text-subhead);
        font-weight: 500;
        text-align: center;
        display: none;
        border: 0.5px solid transparent;
      }

      .status.show {
        display: block;
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .status.scanning {
        background: color-mix(in srgb, var(--system-blue) 10%, transparent);
        color: var(--system-blue);
        border-color: color-mix(in srgb, var(--system-blue) 20%, transparent);
      }

      .status.success {
        background: color-mix(in srgb, var(--system-green) 10%, transparent);
        color: var(--system-green);
        border-color: color-mix(in srgb, var(--system-green) 20%, transparent);
      }

      .status.error {
        background: color-mix(in srgb, var(--system-red) 10%, transparent);
        color: var(--system-red);
        border-color: color-mix(in srgb, var(--system-red) 20%, transparent);
      }

      .video-count {
        font-size: var(--text-subhead);
        font-weight: 500;
        color: var(--label-secondary);
        margin-bottom: var(--spacing-md);
        padding: var(--spacing-md);
        background: var(--background-tertiary);
        border-radius: var(--radius-md);
        text-align: center;
        border: 0.5px solid var(--separator);
      }

      .video-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
      }

      .video-item {
        background: var(--background-primary);
        border: 0.5px solid var(--separator);
        border-radius: var(--radius-md);
        overflow: hidden;
        box-shadow: var(--shadow-sm);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .video-item:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
        border-color: color-mix(
          in srgb,
          var(--system-blue) 30%,
          var(--separator)
        );
      }

      .video-preview {
        width: 100%;
        height: 100px;
        background: var(--system-gray6);
        position: relative;
        overflow: hidden;
      }

      .video-preview img,
      .video-preview video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .video-preview .placeholder {
        width: 100%;
        height: 100%;
        background: linear-gradient(
          135deg,
          var(--system-purple) 0%,
          var(--system-blue) 100%
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 32px;
      }

      .play-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 40px;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(8px);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: var(--text-body);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid rgba(255, 255, 255, 0.3);
      }

      .play-overlay:hover {
        background: rgba(0, 0, 0, 0.9);
        transform: translate(-50%, -50%) scale(1.1);
      }

      .video-info {
        padding: var(--spacing-md);
      }

      .video-title {
        font-weight: 600;
        font-size: var(--text-subhead);
        color: var(--label-primary);
        margin-bottom: var(--spacing-sm);
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        letter-spacing: -0.2px;
      }

      .video-meta {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
        margin-bottom: var(--spacing-md);
        font-size: var(--text-caption1);
      }

      .video-meta .badge {
        padding: 4px var(--spacing-sm);
        border-radius: var(--radius-sm);
        font-weight: 600;
        font-size: var(--text-caption2);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .video-meta .resolution {
        background: color-mix(in srgb, var(--system-blue) 15%, transparent);
        color: var(--system-blue);
      }

      .video-meta .size {
        background: color-mix(in srgb, var(--system-purple) 15%, transparent);
        color: var(--system-purple);
      }

      .video-meta .duration {
        background: color-mix(in srgb, var(--system-green) 15%, transparent);
        color: var(--system-green);
      }

      .video-actions {
        display: flex;
        gap: var(--spacing-sm);
        align-items: center;
      }

      .quality-select {
        flex: 1;
        padding: var(--spacing-sm) var(--spacing-md);
        border: 0.5px solid var(--separator);
        border-radius: var(--radius-sm);
        font-size: var(--text-subhead);
        background: var(--background-tertiary);
        color: var(--label-primary);
        font-family: inherit;
        min-height: 44px;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .quality-select:focus {
        outline: none;
        border-color: var(--system-blue);
        box-shadow: 0 0 0 3px
          color-mix(in srgb, var(--system-blue) 20%, transparent);
      }

      .download-btn {
        padding: var(--spacing-sm) var(--spacing-md);
        background: var(--system-green);
        color: white;
        border: none;
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-size: var(--text-subhead);
        font-weight: 600;
        font-family: inherit;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-xs);
      }

      .download-btn:hover {
        background: var(--system-green-hover);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
      }

      .download-btn:active {
        transform: translateY(0);
        box-shadow: var(--shadow-sm);
      }

      .download-btn:disabled {
        background: var(--system-gray3);
        color: var(--label-quaternary);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .progress-container {
        margin-top: var(--spacing-md);
        display: none;
      }

      .progress-container.show {
        display: block;
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .progress-bar {
        width: 100%;
        height: 6px;
        background: var(--system-gray5);
        border-radius: 3px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: var(--system-green);
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        width: 0%;
        border-radius: 3px;
      }

      .progress-text {
        font-size: var(--text-caption1);
        color: var(--label-secondary);
        margin-top: var(--spacing-xs);
        text-align: center;
        font-weight: 500;
      }

      .empty-state {
        text-align: center;
        padding: var(--spacing-xxl) var(--spacing-lg);
        color: var(--label-secondary);
        animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .empty-state .icon {
        font-size: 64px;
        margin-bottom: var(--spacing-lg);
        opacity: 0.6;
        filter: grayscale(0.3);
      }

      .empty-state h3 {
        margin: 0 0 var(--spacing-sm) 0;
        font-size: var(--text-title3);
        color: var(--label-primary);
        font-weight: 600;
        letter-spacing: -0.4px;
      }

      .empty-state p {
        margin: 0;
        font-size: var(--text-subhead);
        line-height: 1.5;
        max-width: 280px;
        margin: 0 auto;
      }

      .scanning-indicator {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-xl);
        gap: var(--spacing-md);
        color: var(--label-secondary);
        animation: fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .debug-panel {
        background: var(--background-tertiary);
        border: 0.5px solid var(--separator);
        border-radius: var(--radius-md);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
        font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono",
          monospace;
        font-size: var(--text-caption1);
        display: none;
        max-height: 200px;
        overflow-y: auto;
        box-shadow: var(--shadow-sm);
      }

      .debug-panel.show {
        display: block;
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .debug-panel pre {
        margin: 0;
        white-space: pre-wrap;
        word-break: break-all;
        color: var(--label-secondary);
        line-height: 1.5;
      }

      .spinner {
        width: 24px;
        height: 24px;
        border: 2px solid var(--system-gray5);
        border-top: 2px solid var(--system-blue);
        border-radius: 50%;
        animation: spin 1s cubic-bezier(0.4, 0, 0.2, 1) infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .download-manager {
        background: var(--background-primary);
        border: 0.5px solid var(--separator);
        border-radius: var(--radius-md);
        margin-bottom: var(--spacing-md);
        overflow: hidden;
        box-shadow: var(--shadow-sm);
      }

      .section-title {
        margin: 0;
        padding: var(--spacing-md) var(--spacing-md);
        background: var(--background-secondary);
        border-bottom: 0.5px solid var(--separator);
        font-size: var(--text-subhead);
        font-weight: 600;
        color: var(--label-primary);
        letter-spacing: -0.2px;
      }

      .download-list {
        padding: var(--spacing-sm);
      }

      .download-item {
        padding: var(--spacing-md);
        border: 0.5px solid var(--separator);
        border-radius: var(--radius-sm);
        margin-bottom: var(--spacing-sm);
        background: var(--background-tertiary);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .download-item:last-child {
        margin-bottom: 0;
      }

      .download-item:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }

      .download-title {
        font-weight: 600;
        font-size: var(--text-subhead);
        color: var(--label-primary);
        margin-bottom: var(--spacing-xs);
        display: -webkit-box;
        -webkit-line-clamp: 1;
        line-clamp: 1;
        -webkit-box-orient: vertical;
        overflow: hidden;
        letter-spacing: -0.2px;
      }

      .download-progress-container {
        margin-bottom: var(--spacing-sm);
      }

      .download-progress-bar {
        width: 100%;
        height: 4px;
        background: var(--system-gray5);
        border-radius: 2px;
        overflow: hidden;
      }

      .download-progress-fill {
        height: 100%;
        background: var(--system-blue);
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        width: 0%;
        border-radius: 2px;
      }

      .download-progress-fill.completed {
        background: var(--system-green);
      }

      .download-progress-fill.error {
        background: var(--system-red);
      }

      .download-status {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: var(--text-caption1);
        color: var(--label-secondary);
        margin-top: var(--spacing-xs);
        font-weight: 500;
      }

      .download-controls {
        display: flex;
        gap: var(--spacing-xs);
      }

      .download-control-btn {
        padding: 4px var(--spacing-sm);
        border: none;
        border-radius: var(--radius-sm);
        background: var(--system-gray);
        color: white;
        cursor: pointer;
        font-size: var(--text-caption2);
        font-weight: 600;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        min-height: 32px;
        min-width: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .download-control-btn:hover {
        transform: translateY(-1px);
        box-shadow: var(--shadow-sm);
      }

      .download-control-btn.pause {
        background: var(--system-yellow);
        color: var(--label-primary);
      }

      .download-control-btn.resume {
        background: var(--system-green);
      }

      .download-control-btn.cancel {
        background: var(--system-red);
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>üé¨ Video Downloader</h1>
      <div class="status-info">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Ready</span>
      </div>
    </div>

    <div class="controls">
      <button class="btn" id="rescanBtn">üîÑ Rescan</button>
      <button class="btn secondary" id="forceReloadBtn">‚ö° Force Reload</button>
      <button class="btn secondary" id="clearBtn">üóëÔ∏è Clear</button>
      <button class="btn secondary" id="debugBtn">üîç Debug</button>
    </div>

    <div class="status" id="statusMessage"></div>

    <div class="debug-panel" id="debugPanel">
      <pre id="debugContent">
Click Debug button to view storage contents...</pre
      >
    </div>

    <div class="video-count" id="videoCount" style="display: none">
      No videos detected
    </div>

    <div class="download-manager" id="downloadManager" style="display: none">
      <h3 class="section-title">üì• Active Downloads</h3>
      <div class="download-list" id="downloadList"></div>
    </div>

    <div
      class="scanning-indicator"
      id="scanningIndicator"
      style="display: none"
    >
      <div class="spinner"></div>
      <span>Scanning for videos...</span>
    </div>

    <div class="empty-state" id="emptyState">
      <div class="icon">üìπ</div>
      <h3>No Videos Found</h3>
      <p>
        Click the extension icon on a webpage with videos to start detecting
        downloadable content.
      </p>
    </div>

    <div class="video-list" id="videoList"></div>

    <script src="sidepanel.js"></script>
  </body>
</html>
